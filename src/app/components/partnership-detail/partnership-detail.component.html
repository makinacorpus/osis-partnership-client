<app-loader *ngIf="!data"></app-loader>

<div *ngIf="data">
  <a class="btn btn-link" [routerLink]="['/partners', data.partner.uuid]" queryParamsHandling="merge" *ngIf="showBackButton">
    <i class="fa fa-chevron-left" aria-hidden="true"></i>
    {{'Back to partnership list' | translate}}
  </a>
  <dl class="detail-partnership">
    <dt *ngIf="data.partner.name">{{ 'Partner' | translate }}</dt>
    <dd *ngIf="data.partner.name">
      <a class="detail-partnership__name" [href]="data.partner.website" rel="noopener" target="blank" [title]="'Go to partners website' | translate">
        {{data.partner.name}}
      </a> <span *ngIf="data.partner.erasmus_code">({{data.partner.erasmus_code}})</span><br/>
      <span *ngIf="data.partner_entity">{{data.partner_entity}}<br /></span>
      <span class="detail-partnership__city">{{data.partner.city}}, </span>
      <span>{{data.partner.country}}</span>
    </dd>

    <dt>{{ 'UCLouvain' | translate }}</dt>
    <dd>
        <span *ngIf="data.ucl_faculty && data.ucl_faculty.acronym != data.ucl_entity.acronym">
          {{data.ucl_faculty.title}} ({{data.ucl_faculty.acronym}})<br/>
        </span>
        {{data.ucl_entity.title}} ({{data.ucl_entity.acronym}})
    </dd>

    <dt *ngIf="data.supervisor">{{ 'UCLouvain academic coordinator' | translate }}</dt>
    <dd *ngIf="data.supervisor">Prof. {{data.supervisor}}</dd>

    <dt *ngIf="data.education_fields">{{ 'Subject area' | translate }}</dt>
    <dd *ngIf="data.education_fields">
      <ul class="partnership__list">
        <li *ngFor="let field of data.education_fields">{{field}}</li>
      </ul>
    </dd>

    <dt>{{ 'Type of mobility' | translate }}</dt>
    <dd>{{mobilityType}}</dd>

    <dt>{{ 'Status' | translate }}</dt>
    <dd *ngIf="!!data.status">{{ data.status.status | translate }} <span *ngIf="isValidated(data.status)">({{data.status.valid_years}})</span></dd>
    <dd *ngIf="!data.status">{{ 'waiting' | translate }}</dd>

    <dt *ngIf="data.bilateral_agreements && data.bilateral_agreements.length > 0">{{ 'Bilateral agreements' | translate }}</dt>
    <dd *ngIf="data.bilateral_agreements && data.bilateral_agreements.length > 0">
      <ul class="partnership__list">
        <li *ngFor="let bilateral_agreement of data.bilateral_agreements">
          <a [href]="bilateral_agreement.url">{{bilateral_agreement.name}}</a>
        </li>
      </ul>
    </dd>
  </dl>

  <tabset *ngIf="data">
    <tab id="tab1">
      <ng-template tabHeading>
        {{ 'Information for outgoing students' | translate }}
      </ng-template>

      <div class="detail-partnership__tab">
        <dl class="detail-partnership">
          <dt class="nomargin">{{ 'Level of study' | translate }}</dt>
          <dd class="nomargin" *ngIf="!data.out_education_levels || !data.out_education_levels.length">
            {{ 'Bachelor' | translate }}, {{ 'Master' | translate }}
          </dd>

          <dd class="nomargin" *ngIf="data.out_education_levels && data.out_education_levels.length">
            {{ getEducationLevels() }}
          </dd>

          <dt class="nomargin">{{ 'Faculty/School' | translate }}</dt>
          <dd class="nomargin" *ngIf="data.out_entities && data.out_entities.length">
            <ng-container *ngFor="let entity of data.out_entities; index as index"><ng-container *ngIf="index !== 0">, </ng-container><span class="has-tooltip" [tooltip]="entity.title">{{entity.acronym}}</span></ng-container>
          </dd>
          <dd class="nomargin" *ngIf="!data.out_entities || !data.out_entities.length">{{ 'All' | translate }}</dd>

          <dt>{{ 'Program' | translate }}</dt>
          <dd *ngIf="!data.out_university_offers || !data.out_university_offers.length">
            {{ 'All programs' | translate }}
          </dd>

          <dd *ngIf="data.out_university_offers && data.out_university_offers.length">
            <ul *ngFor="let level of data.out_university_offers" class="partnership__list">
              <li>{{level}}</li>
            </ul>
          </dd>

          <dt class="nomargin" *ngIf="data.out_contact && (data.out_contact.first_name || data.out_contact.last_name)">{{ 'Contact person OUT' | translate }}</dt>
          <dd  class="nomargin" *ngIf="data.out_contact.first_name || data.out_contact.last_name">
            <span *ngIf="data.out_contact.first_name || data.out_contact.last_name">{{data.out_contact.first_name}} {{data.out_contact.last_name}}<br/></span>
          </dd>

          <dt class="nomargin" *ngIf="data.out_contact && data.out_contact.email">{{ 'E-mail' | translate }}</dt>
          <dd  class="nomargin" *ngIf="data.out_contact.first_name || data.out_contact.last_name">
            <a href="mailto:{{data.out_contact.email}}" *ngIf="data.out_contact.email">{{data.out_contact.email}}</a>
          </dd>

          <dt *ngIf="data.out_portal">{{ 'Portal OUT' | translate }}</dt>
          <dd *ngIf="data.out_portal">
            <a [href]="data.out_portal" target="blank" rel="noopener">{{data.out_portal}}</a>
          </dd>

          <dt>{{ 'Funding' | translate }}</dt>
          <dd>
            <span *ngIf="!data.out_funding">-</span>
            <a *ngIf="data.out_funding" [href]="data.out_funding.url" rel="noopener" target="blank">{{data.out_funding.name}}</a>
          </dd>

          <dt *ngIf="data.out_partner_contacts && data.out_partner_contacts.length > 0">{{ 'Contact person in partner institution' | translate }}</dt>
          <dd *ngIf="data.out_partner_contacts && data.out_partner_contacts.length > 0">
            <ul class="partnership__list">
              <li *ngFor="let contact of data.out_partner_contacts">
                <span *ngIf="contact.title || contact.first_name || contact.last_name">
                  {{contact.title}} {{contact.first_name}} {{contact.last_name}}<br></span>
                <span *ngIf="contact.phone">{{contact.phone}}<br></span>
                <a href="mailto:{{contact.email}}" *ngIf="contact.email">{{contact.email}}</a>
              </li>
            </ul>
          </dd>

          <dt>{{ 'Individual Student Evaluations' | translate }}</dt>
          <dd>{{ 'Address coming soon' | translate }}</dd>

          <dt *ngIf="data.out_summary_tables && data.out_summary_tables.length > 0">{{ 'Summary Tables' | translate }}</dt>
          <dd *ngIf="data.out_summary_tables && data.out_summary_tables.length > 0">
            <ul class="partnership__list">
              <li *ngFor="let summary_table of data.out_summary_tables">
                <a [href]="summary_table.url">{{summary_table.name}}</a>
              </li>
            </ul>
          </dd>
        </dl>
      </div>
    </tab>
    <tab>
      <ng-template tabHeading>
        {{ 'Information for incoming students' | translate }}
      </ng-template>
      <div class="detail-partnership__tab">
        <dl class="detail-partnership">
          <dt class="nomargin" *ngIf="data.in_contact && (data.in_contact.first_name || data.in_contact.last_name)">{{ 'Contact person IN' | translate }}</dt>
          <dd class="nomargin" *ngIf="data.in_contact.first_name || data.in_contact.last_name">
            <span *ngIf="data.in_contact.first_name || data.in_contact.last_name">{{data.in_contact.first_name}} {{data.in_contact.last_name}}<br/></span>
          </dd>

          <dt class="nomargin" *ngIf="data.in_contact && data.in_contact.email"></dt>
          <dd class="nomargin" *ngIf="data.in_contact && data.in_contact.email">
            <a href="mailto:{{data.in_contact.email}}" *ngIf="data.in_contact.email">{{data.in_contact.email}}</a>
          </dd>

          <dt *ngIf="data.in_portal"></dt>
          <dd *ngIf="data.in_portal">
            <a [href]="data.in_portal" target="blank" rel="noopener">
              {{ 'Web portal incoming' | translate }}
              <span *ngIf="data.ucl_faculty && data.ucl_faculty != data.ucl_entity">{{ data.ucl_entity.acronym }}/</span>
              {{data.ucl_entity.acronym}}
            </a>
          </dd>

          <dt>{{ 'Admission' | translate }}</dt>
          <dd><a href="http://www.uclouvain.be/en-exchange-application" target="_blank"><span [innerHTML]="'Admission Text 1' | translate"></span></a><br><span [innerHTML]="'Admission Text 2' | translate"></span></dd>

          <dt>{{ 'Course catalogue' | translate }}</dt>
          <dd>
            <a [href]="getCourseCatalogueUrl()" *ngIf="getCourseCatalogueUrl()" target="_blank">{{ 'Link to course catalogue' | translate }}</a>
            <br><span *ngIf="getCourseCatalogueText()">{{ getCourseCatalogueText() }}</span>
          </dd>

          <dt>{{ 'Useful links' | translate }}</dt>
          <dd>
            <a target="blank" rel="noopener"
              [href]="'general_information_url' | translate">{{ 'General information for incoming exchange students' | translate }}</a><br>
            <a target="blank" rel="noopener"
              [href]="'internation_welcome_guide_url' | translate">{{ 'International Welcome Guide' | translate }}</a>
          </dd>
        </dl>
      </div>
    </tab>
    <tab>
      <ng-template tabHeading>
        {{ 'Information for outgoing teaching staff' | translate }}
      </ng-template>
      <div class="detail-partnership__tab">
        <dl class="detail-partnership">
          <dt *ngIf="data.staff_contact">{{ 'Contact person' | translate }}</dt>
          <dd *ngIf="data.staff_contact"><a [href]="'mailto:' + data.staff_contact.email">{{data.staff_contact.first_name}} {{data.staff_contact.last_name}}</a></dd>

          <dt *ngIf="data.staff_partner_contacts && data.staff_partner_contacts.length > 0">{{ 'Contact person in partner institution' | translate }}</dt>
          <dd *ngIf="data.staff_partner_contacts && data.staff_partner_contacts.length > 0">
            <ul class="partnership__list">
              <li *ngFor="let contact of data.out_partner_contacts">
                <span *ngIf="contact.title || contact.first_name || contact.last_name">
                  {{contact.title}} {{contact.first_name}} {{contact.last_name}}<br></span>
                <span *ngIf="contact.phone">{{contact.phone}}<br></span>
                <a href="mailto:{{contact.email}}" *ngIf="contact.email">{{contact.email}}</a>
              </li>
            </ul>
          </dd>

          <dt>{{ 'Funding' | translate }}</dt>
          <dd>
            <a [href]="'funding_staff_url' | translate" rel="noopener" target="blank">{{ 'Open call for staff mobility' | translate }}</a>
          </dd>

          <dt *ngIf="data.medias && data.medias.length > 0">{{ 'Medias' | translate }}</dt>
          <dd *ngIf="data.medias && data.medias.length > 0">
            <ul class="partnership__list">
              <li *ngFor="let media of data.medias">
                <a [href]="media.url">{{media.name}}</a>
              </li>
            </ul>
          </dd>
        </dl>
      </div>
    </tab>
  </tabset>
</div>
